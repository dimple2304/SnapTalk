<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Profile / SnapTalk</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    /* Desktop Styles */
    .swal2-popup {
      border-radius: 1rem !important;
      max-width: 35rem !important;
      width: 100% !important;
      padding: 1.5rem !important;
    }

    .swal2-html-container {
      margin: 0 !important;
      padding: 0 !important;
      max-height: 560px !important;
      overflow-y: auto !important;
    }

    /* Mobile Styles for Full Screen */
    @media (max-width: 639px) {
      .swal2-popup {
        max-width: 100vw !important;
        width: 100vw !important;
        height: 100vh !important;
        border-radius: 0 !important;
        margin: 0 !important;
        padding: 1.5rem 1rem !important;
      }

      .swal2-html-container {
        height: 100% !important;
        max-height: none !important;
      }
    }
  </style>
</head>

<body class="bg-slate-100 flex items-center justify-center min-h-screen p-4 sm:p-4">

  <div id="edit-profile-modal" class="hidden w-full flex flex-col h-screen sm:h-[420px]">

    <div class="text-center mb-4">
      <h2 class="text-xl font-bold text-gray-900">Edit Your Profile</h2>
      <p class="mt-1 text-gray-500 text-sm">Make changes to your profile information below.</p>
      <span id="edit-error" class="error text-red-600 text-sm"></span>
    </div>

    <form id="single-step-form" class="pl-1 pb-1 flex-1 space-y-5 overflow-y-auto pr-2">

      <div id="spinner-partial-call" class="editSpinner">
        <%- include('../partials/spinner') %>
      </div>

      <div>
        <label id="profile-pic-label" class="relative cursor-pointer group w-36 h-36 block">
          <img name="profilepic" id="image-preview" src="<%= profile.profilepic ? profile.profilepic : `https://placehold.co/128x128/1d4ed8/ffffff?text=${user.name.split('')[0].toUpperCase()}` %>" alt="Profile picture preview" class="w-36 h-36 rounded-full object-cover border-4 border-slate-200">

          <div class="absolute inset-0 bg-black bg-opacity-10 flex items-center justify-center rounded-full transition-opacity duration-300">
            <svg class="w-8 h-8 text-black opacity-0 hover:opacity-100 transition-opacity duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
          </div>
        </label>
        <input type="file" id="profile-pic-input" class="sr-only" accept="image/*">
      </div>


      <div>
        <label for="name-input" class="block mb-1 text-sm font-bold text-gray-700 text-left">Name</label>
        <input type="text" name="name" id="name-input" placeholder="Enter your full name" class="w-full px-4 py-2 bg-slate-100 border border-slate-300 rounded-lg
                focus:outline-none focus:border-indigo-500 focus:ring-2 focus:ring-indigo-500 transition" value="<%= user.name %>">
        <span id="name-error" class="flex error text-red-600 text-sm"></span>
      </div>

      <div>
        <label for="username-input" class="block mb-1 text-sm font-bold text-gray-700 text-left">Username</label>
        <div class="relative">
          <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
            <span class="text-gray-500 font-semibold">@</span>
          </div>
          <input type="text" id="username-input" name="username" value="<%= user.username %>" placeholder="your_unique_username" class="w-full pl-7 pr-4 py-2 bg-slate-100 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 transition">
        </div>
        <span id="username-error" class="flex error text-red-600 text-sm self-start"></span>
      </div>

      <div>
        <label for="bio-input" class="block mb-1 text-sm font-bold text-gray-700 text-left">Bio</label>
        <textarea id="bio-input" name="bio" rows="3" placeholder="Your bio..." class="w-full px-4 py-2 bg-slate-100 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition resize-none"><%= profile.bio %></textarea>
      </div>

      <div>
        <label class="block mb-1 text-sm font-bold text-gray-700 text-left">Website</label>
        <div class="space-y-2">
          <input type="text" id="link-label-input" name="linkLabel" value="<%= profile.link.label %>" placeholder="Label (e.g., My Portfolio)" class="w-full px-4 py-2 bg-slate-100 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
          <input type="url" id="link-url-input" name="link" value="<%= profile.link.url %>" placeholder="URL (https://example.com)" class="w-full px-4 py-2 bg-slate-100 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
        </div>
      </div>
    </form>

    <div class="mt-auto pt-4 border-t border-slate-200 flex justify-end items-center">
      <button id="save-changes" class="bg-black text-white font-bold py-2 px-5 rounded-full hover:bg-gray-700 transition-colors text-sm">
        Save Changes
      </button>
    </div>
  </div>

  <script src="/js/editProfile.js"></script>
</body>

</html>